# üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Google Drive API

–î–µ—Ç–∞–ª—å–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Google Drive API –¥–ª—è —Ö–º–∞—Ä–Ω–æ—ó –ø–∞–º'—è—Ç—ñ AI-–∞–≥–µ–Ω—Ç–∞.

## –ö—Ä–æ–∫ 1: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—É –≤ Google Cloud Console

1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ [Google Cloud Console](https://console.cloud.google.com/)
2. –£–≤—ñ–π–¥—ñ—Ç—å —É —Å–≤—ñ–π Google –∞–∫–∞—É–Ω—Ç
3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"Select a project"** ‚Üí **"New Project"**
4. –í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É –ø—Ä–æ—î–∫—Ç—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "Trading Agent")
5. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"Create"**

## –ö—Ä–æ–∫ 2: –£–≤—ñ–º–∫–Ω–µ–Ω–Ω—è Google Drive API

1. –£ –º–µ–Ω—é –∑–ª—ñ–≤–∞ –≤–∏–±–µ—Ä—ñ—Ç—å **"APIs & Services"** ‚Üí **"Library"**
2. –£ –ø–æ—à—É–∫—É –≤–≤–µ–¥—ñ—Ç—å **"Google Drive API"**
3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ **"Google Drive API"**
4. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É **"Enable"**

## –ö—Ä–æ–∫ 3: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è OAuth 2.0 Credentials

1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ **"APIs & Services"** ‚Üí **"Credentials"**
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"+ CREATE CREDENTIALS"** ‚Üí **"OAuth client ID"**
3. –Ø–∫—â–æ –≤–∞—Å –ø–æ–ø—Ä–æ—Å—è—Ç—å –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ OAuth consent screen:
   - –í–∏–±–µ—Ä—ñ—Ç—å **"External"** (–¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è)
   - –ó–∞–ø–æ–≤–Ω—ñ—Ç—å –æ–±–æ–≤'—è–∑–∫–æ–≤—ñ –ø–æ–ª—è:
     - **App name**: Trading Agent
     - **User support email**: –≤–∞—à email
     - **Developer contact information**: –≤–∞—à email
   - –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"Save and Continue"**
   - –ù–∞ –µ–∫—Ä–∞–Ω—ñ Scopes –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å **"Save and Continue"**
   - –ù–∞ –µ–∫—Ä–∞–Ω—ñ Test users –¥–æ–¥–∞–π—Ç–µ —Å–≤—ñ–π email (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ)
   - –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"Save and Continue"**
   - –ù–∞ –µ–∫—Ä–∞–Ω—ñ Summary –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å **"Back to Dashboard"**

4. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è OAuth Client ID:
   - **Application type**: –≤–∏–±–µ—Ä—ñ—Ç—å **"Desktop app"**
   - **Name**: Trading Agent Client (–∞–±–æ –±—É–¥—å-—è–∫–∞ –Ω–∞–∑–≤–∞)
   - –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"Create"**

5. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ credentials:
   - –£ –≤—ñ–∫–Ω—ñ, —â–æ –∑'—è–≤–∏—Ç—å—Å—è, –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å **"Download JSON"**
   - –ü–µ—Ä–µ–π–º–µ–Ω—É–π—Ç–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π —Ñ–∞–π–ª —É `client_secrets.json`
   - –ü–µ—Ä–µ–º—ñ—Å—Ç—ñ—Ç—å —Ñ–∞–π–ª —É –ø–∞–ø–∫—É –ø—Ä–æ—î–∫—Ç—É `—Ä–æ–∑—É–º–Ω–∏–π –∞–≥–µ–Ω—Ç/`

## –ö—Ä–æ–∫ 4: –ü–µ—Ä—à–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è (–ª–æ–∫–∞–ª—å–Ω–æ)

1. –ó–∞–ø—É—Å—Ç—ñ—Ç—å –ø—Ä–æ—î–∫—Ç –ª–æ–∫–∞–ª—å–Ω–æ:
   ```bash
   cd "—Ä–æ–∑—É–º–Ω–∏–π –∞–≥–µ–Ω—Ç"
   python app.py
   ```

2. –ü—Ä–∏ –ø–µ—Ä—à–æ–º—É –∑–∞–ø—É—Å–∫—É –∑'—è–≤–∏—Ç—å—Å—è URL –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó:
   - –°–∫–æ–ø—ñ—é–π—Ç–µ URL —É –±—Ä–∞—É–∑–µ—Ä
   - –£–≤—ñ–π–¥—ñ—Ç—å —É —Å–≤—ñ–π Google –∞–∫–∞—É–Ω—Ç
   - –ù–∞–¥–∞–π—Ç–µ –¥–æ–∑–≤–æ–ª–∏ –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ Google Drive
   - –ü—ñ—Å–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è —Ñ–∞–π–ª `token.json`

3. –§–∞–π–ª `token.json` –º—ñ—Å—Ç–∏—Ç—å refresh token, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø.

## –ö—Ä–æ–∫ 5: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è Render

### –í–∞—Ä—ñ–∞–Ω—Ç A: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Secret Files (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)

1. –£ Render Dashboard ‚Üí –≤–∞—à —Å–µ—Ä–≤—ñ—Å ‚Üí **"Environment"**
2. –ü—Ä–æ–∫—Ä—É—Ç—ñ—Ç—å –¥–æ **"Secret Files"**
3. –°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª `client_secrets.json`:
   - –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"Add Secret File"**
   - **Name**: `client_secrets.json`
   - **Contents**: –≤—Å—Ç–∞–≤—Ç–µ –≤–º—ñ—Å—Ç –≤–∞—à–æ–≥–æ `client_secrets.json` —Ñ–∞–π–ª—É

4. –°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª `token.json` (—è–∫—â–æ –≤—ñ–Ω –≤–∂–µ —ñ—Å–Ω—É—î –ø—ñ—Å–ª—è –ª–æ–∫–∞–ª—å–Ω–æ—ó –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó):
   - –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"Add Secret File"**
   - **Name**: `token.json`
   - **Contents**: –≤—Å—Ç–∞–≤—Ç–µ –≤–º—ñ—Å—Ç –≤–∞—à–æ–≥–æ `token.json` —Ñ–∞–π–ª—É

### –í–∞—Ä—ñ–∞–Ω—Ç B: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Environment Variables

–Ø–∫—â–æ Render –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î Secret Files, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ base64:

1. –ö–æ–Ω–≤–µ—Ä—Ç—É–π—Ç–µ `client_secrets.json` —É base64:
   ```bash
   # Windows PowerShell
   [Convert]::ToBase64String([IO.File]::ReadAllBytes("client_secrets.json"))
   
   # Linux/Mac
   cat client_secrets.json | base64
   ```

2. –î–æ–¥–∞–π—Ç–µ Environment Variable:
   - **Key**: `GOOGLE_CLIENT_SECRETS_B64`
   - **Value**: –≤–∞—à base64 —Ä—è–¥–æ–∫

3. –ú–æ–¥–∏—Ñ—ñ–∫—É–π—Ç–µ `app.py` –¥–ª—è –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è (–¥–æ–¥–∞–π—Ç–µ –Ω–∞ –ø–æ—á–∞—Ç–∫—É —Ñ–∞–π–ª—É):
   ```python
   import base64
   import json
   
   # –î–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è client_secrets.json –∑ environment variable
   if os.getenv("GOOGLE_CLIENT_SECRETS_B64"):
       secrets_b64 = os.getenv("GOOGLE_CLIENT_SECRETS_B64")
       secrets_json = base64.b64decode(secrets_b64).decode('utf-8')
       with open(CLIENT_SECRETS_FILE, 'w') as f:
           f.write(secrets_json)
   ```

## –ö—Ä–æ–∫ 6: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–±–æ—Ç–∏

1. –ü—ñ—Å–ª—è —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –Ω–∞ Render –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏:
   - Render Dashboard ‚Üí –≤–∞—à —Å–µ—Ä–≤—ñ—Å ‚Üí **"Logs"**
   - –®—É–∫–∞–π—Ç–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è/–∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ

2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ API –µ–Ω–¥–ø–æ—ñ–Ω—Ç:
   ```bash
   curl https://your-app.onrender.com/status
   ```

3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ Google Drive:
   - –í—ñ–¥–∫—Ä–∏–π—Ç–µ [Google Drive](https://drive.google.com/)
   - –®—É–∫–∞–π—Ç–µ —Ñ–∞–π–ª `agent_model.keras`
   - –ü—ñ—Å–ª—è –ø–µ—Ä—à–æ–≥–æ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Å–∫–æ–ø—ñ—é–π—Ç–µ File ID
   - –î–æ–¥–∞–π—Ç–µ `MODEL_DRIVE_FILE_ID` —É Environment Variables –Ω–∞ Render

## ‚ö†Ô∏è –í–∞–∂–ª–∏–≤—ñ –ó–∞—É–≤–∞–∂–µ–Ω–Ω—è

1. **Test Users**: –Ø–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ External OAuth consent screen, –¥–æ–¥–∞–π—Ç–µ —Å–≤—ñ–π email —É —Å–ø–∏—Å–æ–∫ Test Users.

2. **Token Refresh**: `token.json` –º—ñ—Å—Ç–∏—Ç—å refresh token, —è–∫–∏–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è. –ó–±–µ—Ä—ñ–≥–∞–π—Ç–µ —Ü–µ–π —Ñ–∞–π–ª –≤ –±–µ–∑–ø–µ—Ü—ñ.

3. **Quota**: Google Drive API –º–∞—î –∫–≤–æ—Ç—É –Ω–∞ –∑–∞–ø–∏—Ç–∏. Free tier –¥–æ–∑–≤–æ–ª—è—î –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –∑–∞–ø–∏—Ç—ñ–≤ –¥–ª—è –Ω–∞—à–æ–≥–æ –≤–∏–ø–∞–¥–∫—É.

4. **File Permissions**: –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ —Ñ–∞–π–ª –º–æ–¥–µ–ª—ñ –Ω–∞ Google Drive –º–∞—î –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø—É (—Å—Ç–≤–æ—Ä–µ–Ω–∏–π —á–µ—Ä–µ–∑ API).

## üêõ Troubleshooting

### –ü–æ–º–∏–ª–∫–∞ "invalid_grant"
- –¢–æ–∫–µ–Ω –∑–∞—Å—Ç–∞—Ä—ñ–≤. –í–∏–¥–∞–ª—ñ—Ç—å `token.json` —Ç–∞ –ø–æ–≤—Ç–æ—Ä—ñ—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é.

### –ü–æ–º–∏–ª–∫–∞ "access_denied"
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —â–æ Google Drive API —É–≤—ñ–º–∫–Ω–µ–Ω–æ.
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —â–æ OAuth consent screen –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ.

### –§–∞–π–ª –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ `MODEL_DRIVE_FILE_ID` —É Environment Variables.
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø—É –¥–æ —Ñ–∞–π–ª—É –Ω–∞ Google Drive.

---

**–ü—ñ–¥—Ç—Ä–∏–º–∫–∞**: –Ø–∫—â–æ –≤–∏–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º–∏, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ –Ω–∞ Render —Ç–∞ –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤—Å—ñ –∫—Ä–æ–∫–∏ –≤–∏–∫–æ–Ω–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ.

